<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.79.0"><meta name=description content="Documentation of GIS for Water"><meta name=author content="Jin IGARASHI"><link rel=icon href=/images/favicon.png type=image/png><title>Deploy vectortiles to gh-pages :: Documentation of GIS for Water</title><link href=/css/nucleus.css?1626585053 rel=stylesheet><link href=/css/fontawesome-all.min.css?1626585053 rel=stylesheet><link href=/css/hybrid.css?1626585053 rel=stylesheet><link href=/css/featherlight.min.css?1626585053 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1626585053 rel=stylesheet><link href=/css/auto-complete.css?1626585053 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1626585053 rel=stylesheet><link href=/css/theme.css?1626585053 rel=stylesheet><link href=/css/hugo-theme.css?1626585053 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1626585053></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/en/setups/installation/deploy_vectortiles/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><div style=font-size:x-large;font-weight:700;color:#fff>GIS for Water</div></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1626585053></script><script type=text/javascript src=/js/auto-complete.js?1626585053></script><script type=text/javascript>var baseurl="https:\/\/docs.water-gis.com\/en";</script><script type=text/javascript src=/js/search.js?1626585053></script></div><div class=highlightable><ul class=topics><li data-nav-id=/en/concept/ title=Concept class=dd-item><a href=/en/concept/><b>1. </b>Concept</a></li><li data-nav-id=/en/setups/ title=Setups class="dd-item
parent"><a href=/en/setups/><b>2. </b>Setups</a><ul><li data-nav-id=/en/setups/preparation/ title=Preparations class=dd-item><a href=/en/setups/preparation/>Preparations</a><ul><li data-nav-id=/en/setups/preparation/install_postgis/ title="Install PostgresSQL/PostGIS database" class=dd-item><a href=/en/setups/preparation/install_postgis/>Install PostgresSQL/PostGIS database</a></li><li data-nav-id=/en/setups/preparation/data_collection/ title="Data Collection and Import data into PostGIS database" class=dd-item><a href=/en/setups/preparation/data_collection/>Data Collection and Import data into PostGIS database</a></li><li data-nav-id=/en/setups/preparation/install_docker/ title="Install Docker" class=dd-item><a href=/en/setups/preparation/install_docker/>Install Docker</a></li></ul></li><li data-nav-id=/en/setups/installation/ title=Installation class="dd-item
parent"><a href=/en/setups/installation/>Installation</a><ul><li data-nav-id=/en/setups/installation/create_vt_repository/ title="Create repository for vectortiles" class=dd-item><a href=/en/setups/installation/create_vt_repository/>Create repository for vectortiles</a></li><li data-nav-id=/en/setups/installation/create_mbtiles/ title="Create mbtiles from PostGIS" class=dd-item><a href=/en/setups/installation/create_mbtiles/>Create mbtiles from PostGIS</a></li><li data-nav-id=/en/setups/installation/design_stylefile/ title="Design Mapbox Style" class=dd-item><a href=/en/setups/installation/design_stylefile/>Design Mapbox Style</a></li><li data-nav-id=/en/setups/installation/deploy_vectortiles/ title="Deploy vectortiles to gh-pages" class="dd-item
parent
active"><a href=/en/setups/installation/deploy_vectortiles/>Deploy vectortiles to gh-pages</a></li><li data-nav-id=/en/setups/installation/deploy_stylefile_sprite/ title="Deploy Mapbox Stylefiles and Sprite files to gh-pages" class=dd-item><a href=/en/setups/installation/deploy_stylefile_sprite/>Deploy Mapbox Stylefiles and Sprite files to gh-pages</a></li><li data-nav-id=/en/setups/installation/develop_mapbox_gl_js/ title="Develop and Deploy Web Application" class=dd-item><a href=/en/setups/installation/develop_mapbox_gl_js/>Develop and Deploy Web Application</a></li></ul></li><li data-nav-id=/en/setups/terrain-rgb/ title="Development of Terrain RGB" class=dd-item><a href=/en/setups/terrain-rgb/>Development of Terrain RGB</a><ul><li data-nav-id=/en/setups/terrain-rgb/create_terrainrgb/ title="Create Terrain RGB tile from DEM" class=dd-item><a href=/en/setups/terrain-rgb/create_terrainrgb/>Create Terrain RGB tile from DEM</a></li><li data-nav-id=/en/setups/terrain-rgb/host-terrainrgb-tiles/ title="Host Terrain RGB tiles on server" class=dd-item><a href=/en/setups/terrain-rgb/host-terrainrgb-tiles/>Host Terrain RGB tiles on server</a></li><li data-nav-id=/en/setups/terrain-rgb/utilize-on-mapboxgl/ title="Utilize Terrain RGB on Mapbox GL JS" class=dd-item><a href=/en/setups/terrain-rgb/utilize-on-mapboxgl/>Utilize Terrain RGB on Mapbox GL JS</a></li></ul></li><li data-nav-id=/en/setups/valhalla/ title="Installation of Valhalla API" class=dd-item><a href=/en/setups/valhalla/>Installation of Valhalla API</a><ul><li data-nav-id=/en/setups/valhalla/setup-valhalla/ title="Setup Valhalla" class=dd-item><a href=/en/setups/valhalla/setup-valhalla/>Setup Valhalla</a></li><li data-nav-id=/en/setups/valhalla/setup-letencrypt/ title="Setup Let's Encrypt to enable SSL" class=dd-item><a href=/en/setups/valhalla/setup-letencrypt/>Setup Let's Encrypt to enable SSL</a></li><li data-nav-id=/en/setups/valhalla/install-valhalla-plugin/ title="Install Valhalla Plugin" class=dd-item><a href=/en/setups/valhalla/install-valhalla-plugin/>Install Valhalla Plugin</a></li></ul></li></ul></li><li data-nav-id=/en/operation/ title=Operations class=dd-item><a href=/en/operation/><b>3. </b>Operations</a><ul><li data-nav-id=/en/operation/automation_updating/ title="Automate data up to date" class=dd-item><a href=/en/operation/automation_updating/>Automate data up to date</a></li><li data-nav-id=/en/operation/costs/ title=Costs class=dd-item><a href=/en/operation/costs/>Costs</a><ul><li data-nav-id=/en/operation/costs/costs_ghpages/ title="Hosting Service of GitHub Pages" class=dd-item><a href=/en/operation/costs/costs_ghpages/>Hosting Service of GitHub Pages</a></li><li data-nav-id=/en/operation/costs/cost_basemaps/ title="Limitation of Base map from third-party map" class=dd-item><a href=/en/operation/costs/cost_basemaps/>Limitation of Base map from third-party map</a></li></ul></li></ul></li><li data-nav-id=/en/casestudies/ title="Case Studies" class=dd-item><a href=/en/casestudies/><b>4. </b>Case Studies</a><ul><li data-nav-id=/en/casestudies/narok/ title="Narok Water, Kenya" class=dd-item><a href=/en/casestudies/narok/>Narok Water, Kenya</a></li><li data-nav-id=/en/casestudies/wasac/ title="WASAC, Rwanda" class=dd-item><a href=/en/casestudies/wasac/>WASAC, Rwanda</a></li><li data-nav-id=/en/casestudies/nakuru/ title="Nakuru Water, Kenya" class=dd-item><a href=/en/casestudies/nakuru/>Nakuru Water, Kenya</a></li><li data-nav-id=/en/casestudies/nanyuki/ title="Nanyuki Water, Kenya" class=dd-item><a href=/en/casestudies/nanyuki/>Nanyuki Water, Kenya</a></li></ul></li><li data-nav-id=/en/packages/ title="Packages and libraries" class=dd-item><a href=/en/packages/><b>5. </b>Packages and libraries</a><ul><li data-nav-id=/en/packages/mapbox-gl-export/ title=mapbox-gl-export class=dd-item><a href=/en/packages/mapbox-gl-export/>mapbox-gl-export</a></li><li data-nav-id=/en/packages/mapbox-gl-legend/ title=mapbox-gl-legend class=dd-item><a href=/en/packages/mapbox-gl-legend/>mapbox-gl-legend</a></li><li data-nav-id=/en/packages/mapbox-gl-elevation/ title=mapbox-gl-elevation class=dd-item><a href=/en/packages/mapbox-gl-elevation/>mapbox-gl-elevation</a></li><li data-nav-id=/en/packages/mapbox-gl-valhalla/ title=mapbox-gl-valhalla class=dd-item><a href=/en/packages/mapbox-gl-valhalla/>mapbox-gl-valhalla</a></li><li data-nav-id=/en/packages/mapbox-gl-area-switcher/ title=mapbox-gl-area-switcher class=dd-item><a href=/en/packages/mapbox-gl-area-switcher/>mapbox-gl-area-switcher</a></li><li data-nav-id=/en/packages/mapbox-gl-popup/ title=mapbox-gl-popup class=dd-item><a href=/en/packages/mapbox-gl-popup/>mapbox-gl-popup</a></li><li data-nav-id=/en/packages/mapbox-gl-pitch-toggle-control/ title=mapbox-gl-pitch-toggle-control class=dd-item><a href=/en/packages/mapbox-gl-pitch-toggle-control/>mapbox-gl-pitch-toggle-control</a></li><li data-nav-id=/en/packages/mapboxgljs-boilerplate/ title=mapboxgljs-boilerplate class=dd-item><a href=/en/packages/mapboxgljs-boilerplate/>mapboxgljs-boilerplate</a></li></ul></li><li data-nav-id=/en/license/ title=License class=dd-item><a href=/en/license/><b>6. </b>License</a></li><li data-nav-id=/en/unvt/ title="Intergration with UNVT" class=dd-item><a href=/en/unvt/><b>7. </b>Intergration with UNVT</a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/watergis/docs><i class="fab fa-fw fa-github"></i>GitHub repo</a></li><li><a class=padding href=https://docs.water-gis.com/en/showcase><i class="fas fa-fw fa-camera"></i>Showcases</a></li><li><a class=padding href=https://docs.water-gis.com/en/tools><i class="fas fa-tools"></i>Third party tools</a></li><li><a class=padding href=https://docs.water-gis.com/en/questions><i class="fas fa-question"></i>Q&A</a></li><li><a class=padding href=https://docs.water-gis.com/en/credits><i class="fas fa-fw fa-bullhorn"></i>Credits</a></li><li><a class=padding href=https://water-gis.com><i class="fas fa-address-card"></i>Contacts</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value;">
<option id=en value=https://docs.water-gis.com/en/setups/installation/deploy_vectortiles/ selected>English</option>
<option id=ja value=https://docs.water-gis.com/ja/setups/installation/deploy_vectortiles/>日本語</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li></ul></section><section id=footer><center><a class=github-button href=https://github.com/watergis/docs data-icon=octicon-star data-show-count=true aria-label="Star watergis/docs on GitHub">Star</a>
<a class=github-button href=https://github.com/watergis/docs/fork data-icon=octicon-repo-forked data-show-count=true aria-label="Fork watergis/docs on GitHub">Fork</a>
<a class=github-button href=https://github.com/sponsors/JinIgarashi aria-label="Sponsor watergis OSS project on GitHub">Sponsor</a><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p><p>Copyright © 2020 Jin IGARASHI</p></center><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/watergis/docs/edit/master/content/setups/installation/deploy_vectortiles/_index.en.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/en/>GIS for Water</a> > <a href=/en/setups/>Setups</a> > <a href=/en/setups/installation/>Installation</a> > Deploy vectortiles to gh-pages</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#deploy-vector-tile-to-gh-pages-work-on-vt>Deploy Vector Tile to gh-pages (work on <code>vt</code>)</a><ul><li><a href=#i-narwasscovt-map-approach-a-case-of-narok-water-kenya>i. [narwassco/vt-map approach] A case of Narok Water, Kenya</a></li><li><a href=#ii-wasacvt-approach-a-case-of-wasac-rwanda-recommended>ii. [WASAC/vt approach] A case of WASAC, Rwanda (Recommended)</a></li></ul></li><li><a href=#in-case-data-size-exceeds-more-than-capacity-of-github-pages>In case data size exceeds more than capacity of Github Pages</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Deploy vectortiles to gh-pages</h1><h2 id=deploy-vector-tile-to-gh-pages-work-on-vt>Deploy Vector Tile to gh-pages (work on <code>vt</code>)</h2><p>Once your stylefiles' design and mbtiles are completed, now you are ready to deploy your vector tiles to gh-pages. <a href=https://github.com/watergis/postgis2vectortiles>postgis2vectortiles</a> will assist you to create and deploy vector tiles.</p><p>There are two cases for deploying.</p><div class=mermaid align=center>graph LR
A[mbtiles] --> B{Is your coverage area large?}
B -->|No|C[narwassco/vt-map]
B -->|Yes|D[wasac/vt]
C -->|produce tiles locally|E[gh-pages]
D -->|upload mbtiles|F[github master branch]
F -->|produce tiles by Github Actions|E</div><h3 id=i-narwasscovt-map-approach-a-case-of-narok-water-kenya>i. [narwassco/vt-map approach] A case of Narok Water, Kenya</h3><p>If your coverage area is small, you can use the approach of <code>Narok Water</code> to deploy. Please have a look following repository.</p><ul><li><a href=https://github.com/narwassco/vt-map>narwassco/vt-map</a>
This module will use the following submodules to create Mapbox Vector Tile for deployment to gh-pages.<ul><li><a href=https://github.com/watergis/postgis2mbtiles>watergis/postgis2mbtiles</a>: It creates <code>mbtiles</code> from PostGIS.</li><li><a href=https://github.com/watergis/mbtiles2pbf>watergis/mbtiles2pbf</a>: It converts from <code>mbtiles</code> to <code>pbf(mvt)</code> tiles.</li></ul></li></ul><p>This module uses <a href=https://github.com/mapbox/tippecanoe>mapbox/tippecanoe</a> for producing mbtiles. However, Narok water&rsquo;s GIS computer is Windows 10 Pro, so it is not easy to run <code>tippecanoe</code>, I developed <code>Docker</code> to create Mapbox Vector Tile.</p><h3 id=ii-wasacvt-approach-a-case-of-wasac-rwanda-recommended>ii. [WASAC/vt approach] A case of WASAC, Rwanda (Recommended)</h3><p>If your coverage area is huge, I am afraid it is not easy to deploy thousands of vector tiles to Github pages. So you can use <code>WASAC</code> approach to deploy <code>mbtiles</code> first, then use <code>Github Actions</code> to extract vector tiles from your <code>mbtiles</code>. You can see the following repository for your reference.</p><ul><li><a href=https://github.com/WASAC/vt>WASAC/vt</a>
This module will use the following submodules to create Mapbox Vector Tile for deployment to gh-pages.<ul><li><a href=https://github.com/watergis/postgis2mbtiles>watergis/postgis2mbtiles</a>: It creates <code>mbtiles</code> from PostGIS. <code>postgis2mbtiles</code> module will run on your local computer.</li><li><a href=https://github.com/watergis/mbtiles2pbf>watergis/mbtiles2pbf</a>: It converts from <code>mbtiles</code> to <code>pbf(mvt)</code> tiles. <code>mbtiles2pbf</code> will run on <code>Github Actions</code>.</li></ul></li></ul><p>The below is a workflow file of <code>Narok Water</code> to automate deploy pbf files from mbtiles by <code>Github Actions</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Node.js CI</span>

<span style=color:#f92672>on</span>:
  <span style=color:#f92672>push</span>:
    <span style=color:#f92672>branches</span>: [ <span style=color:#ae81ff>master ]</span>

<span style=color:#f92672>jobs</span>:
  <span style=color:#f92672>build</span>:

    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>

    <span style=color:#f92672>steps</span>:
    - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Use Node.js</span>
      <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-node@v1</span>
      <span style=color:#f92672>with</span>:
        <span style=color:#f92672>node-version</span>: <span style=color:#ae81ff>12.</span><span style=color:#ae81ff>x</span>
    - <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm ci</span>
      <span style=color:#f92672>env</span>:
        <span style=color:#f92672>NODE_AUTH_TOKEN</span>: <span style=color:#ae81ff>${{secrets.GITHUB_TOKEN}}</span>
    - <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm run extract</span>
    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>configure git and deploy</span>
      <span style=color:#f92672>env</span>:
        <span style=color:#f92672>NODE_AUTH_TOKEN</span>: <span style=color:#ae81ff>${{secrets.GITHUB_TOKEN}}</span>
      <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span><span style=color:#e6db74>        git config --global user.name &#34;narwassco+githubci&#34;
</span><span style=color:#e6db74>        git config --global user.email &#34;narwassco+githubci@users.noreply.github.com&#34;
</span><span style=color:#e6db74>        git remote set-url origin https://x-access-token:${NODE_AUTH_TOKEN}@github.com/narwassco/vt.git
</span><span style=color:#e6db74>        npm run deploy</span>        
</code></pre></div><ul><li><p><code>Narok Water</code> also started using [<code>WASAC/vt</code> approach] instead [<code>narwassco/vt-map</code> approach].</p><ul><li><a href=https://github.com/narwassco/vt>narwassco/vt</a></li></ul></li><li><p><code>Nakuru Water</code> also started using [<code>WASAC/vt</code> approach].</p><ul><li><a href=https://github.com/nakuruwater/vt>nakuruwater/vt</a></li></ul></li></ul><h2 id=in-case-data-size-exceeds-more-than-capacity-of-github-pages>In case data size exceeds more than capacity of Github Pages</h2><p>Github Pages has limitation of usage maximum 1GB storage. If your data exceeds that limit, it is not possible to deploy to gh-pages.</p><p>However, you may have another option to use <a href=https://www.netlify.com>Netlify</a>.</p><p>In Rwanda, we wanted to include parcels data as base map. Parcels in the whole Rwanda is originally 8GB in shapefile. After converting to pbf vector tiles, total size of tiles became 1.2GB. But we successfully managed to deploy parcels by usign Netlify.</p><p>You can have a look the below repository how we deployed huge vector tiles to Netlify.</p><ul><li><a href=https://github.com/WASAC/vt-parcels-2020>WASAC/vt-parcels-2020</a>: Letest parcels as of 21 July 2020</li><li><a href=https://github.com/WASAC/vt-parcels>WASAC/vt-parcels</a>: Old parcels vector tiles before 2019(we are not sure exact surveyed date)</li></ul><p>Because parcels data is huge, we could not extract GeoJSON from PostGIS and to use <strong>tippecanoe</strong>. Thus in this case, we directly extract pbf tiles from PostGIS by using <a href=https://github.com/watergis/mvt-generator>watergis/mvt-generator</a> module. It is quite different approach from what <strong>vt</strong> repository do.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/en/setups/installation/design_stylefile/ title="Design Mapbox Style"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/en/setups/installation/deploy_stylefile_sprite/ title="Deploy Mapbox Stylefiles and Sprite files to gh-pages" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1626585053></script><script src=/js/perfect-scrollbar.min.js?1626585053></script><script src=/js/perfect-scrollbar.jquery.min.js?1626585053></script><script src=/js/jquery.sticky.js?1626585053></script><script src=/js/featherlight.min.js?1626585053></script><script src=/js/highlight.pack.js?1626585053></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js?1626585053></script><script src=/js/learn.js?1626585053></script><script src=/js/hugo-learn.js?1626585053></script><link href=/mermaid/mermaid.css?1626585053 rel=stylesheet><script src=/mermaid/mermaid.js?1626585053></script><script>mermaid.initialize({startOnLoad:true});</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-170080825-6','auto');ga('send','pageview');</script></body></html>